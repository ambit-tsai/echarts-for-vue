{"version":3,"file":"echarts-for-vue.js","sources":["../src/ResizeObserverSham.js","../src/ECharts.js","../src/LifecycleHooks.js"],"sourcesContent":["\r\nfunction ResizeObserverSham() {\r\n    console.warn('[ECharts-For-Vue] \"autoResize\" is invalid, you need a ResizeObserver polyfill');\r\n}\r\n\r\nconst noop = () => {};\r\nResizeObserverSham.prototype.disconnect = noop;\r\nResizeObserverSham.prototype.observe = noop;\r\n\r\n\r\nexport default typeof ResizeObserver === 'function' ? ResizeObserver : ResizeObserverSham;\r\n","import { getHooks } from './LifecycleHooks';\r\nimport ResizeObserverSham from './ResizeObserverSham';\r\n\r\n\r\n/**\r\n * Create a component\r\n * @param {object} options \r\n * @param {echarts} options.echarts\r\n * @param {function} [options.h] `createElement`, required for Vue 3\r\n * @param {function} [options.ResizeObserver]\r\n * @param {string} [options.name]\r\n * @returns {object} definition\r\n */\r\nexport function createComponent({\r\n    echarts,\r\n    h,\r\n    ResizeObserver = ResizeObserverSham,\r\n    name = 'ECharts',\r\n}) {\r\n    const isVue3 = typeof h === 'function';\r\n    const hooks = getHooks(echarts);\r\n\r\n    if (!isVue3) {\r\n        hooks.beforeDestroy = hooks.beforeUnmount;\r\n        delete hooks.beforeUnmount;\r\n    }\r\n\r\n    return {\r\n        ...hooks,\r\n\r\n        name,\r\n        render: isVue3 ? getVue3Render(h) : vue2Render,\r\n    \r\n        props: {\r\n            initTheme: [Object, String],\r\n            initOpts: Object,\r\n            loading: {\r\n                type: Boolean,\r\n                default: false,\r\n            },\r\n            loadingType: {\r\n                type: String,\r\n                default: 'default',\r\n            },\r\n            loadingOpts : Object,\r\n            option: Object,\r\n            setOptionOpts: Object,\r\n            events: Array,\r\n            autoResize: {\r\n                type: Boolean,\r\n                default: true,\r\n            },\r\n        },\r\n    \r\n        data() {\r\n            return {\r\n                _private: Object.freeze({\r\n                    observer: new ResizeObserver(() => this.resize()),\r\n                    dynamic: {},\r\n                }),\r\n            };\r\n        },\r\n\r\n        computed: {\r\n            inst() {\r\n                return this.$data._private.dynamic.inst;\r\n            },\r\n        },\r\n\r\n        watch: {\r\n            loading(val) {\r\n                const ctx = this;\r\n                if (val) {\r\n                    ctx.inst.showLoading(ctx.loadingType, ctx.loadingOpts);\r\n                } else {\r\n                    ctx.inst.hideLoading();\r\n                }\r\n            },\r\n            \r\n            option(val) {\r\n                this.setOption(val, this.setOptionOpts);\r\n            },\r\n\r\n            autoResize(val) {\r\n                if (val) {\r\n                    this.addResizeListener();\r\n                } else {\r\n                    this.removeResizeListener();\r\n                }\r\n            },\r\n        },\r\n    \r\n        methods: {\r\n            setOption(option, opts) {\r\n                this.inst.setOption(option, {\r\n                    ...this.setOptionOpts,\r\n                    ...opts,\r\n                });\r\n            },\r\n    \r\n            resize() {\r\n                const { clientWidth, clientHeight } = this.$el;\r\n                this.inst.resize({\r\n                    width: clientWidth,\r\n                    height: clientHeight,\r\n                });\r\n            },\r\n    \r\n            addResizeListener() {\r\n                this.$data._private.observer.observe(this.$el);\r\n            },\r\n    \r\n            removeResizeListener() {\r\n                this.$data._private.observer.disconnect();\r\n            },\r\n        },\r\n\r\n    };\r\n}\r\n\r\n\r\n\r\nconst style = {\r\n    height: '100%',\r\n    overflow: 'hidden',\r\n};\r\n\r\n\r\nfunction vue2Render(h) {\r\n    return h('div', {\r\n        attrs: this.$attrs,\r\n        style,\r\n    });\r\n}\r\n\r\n\r\nfunction getVue3Render(h) {\r\n    return function () {\r\n        return h('div', {\r\n            ...this.$attrs,\r\n            style,\r\n        });\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Install plugin\r\n * @param {Vue} app \r\n * @param {object} options\r\n */\r\nexport function plugin(app, options) {\r\n    const definition = createComponent(options);\r\n    app.component(definition.name, definition);\r\n}\r\n","\r\nexport function getHooks(echarts) {\r\n    return {\r\n        mounted() {\r\n            const ctx = this;\r\n            const inst = echarts.init(ctx.$el, ctx.initTheme, ctx.initOpts);\r\n            ctx.$data._private.dynamic.inst = inst;\r\n            if (ctx.loading) {\r\n                inst.showLoading(ctx.loadingType, ctx.loadingOpts)\r\n            }\r\n            if (ctx.events) {\r\n                ctx.events.forEach(args => inst.on.apply(inst, args));\r\n            }\r\n            if (ctx.autoResize) {\r\n                ctx.addResizeListener();\r\n            }\r\n            if (ctx.option) {\r\n                // Wait for rendering\r\n                setTimeout(() => {\r\n                    ctx.setOption(ctx.option, ctx.setOptionOpts);\r\n                });\r\n            }\r\n        },\r\n        \r\n        activated() {\r\n            if (this.autoResize) {\r\n                this.addResizeListener();\r\n            }\r\n        },\r\n        \r\n        deactivated() {\r\n            if (this.autoResize) {\r\n                this.removeResizeListener();\r\n            }\r\n        },\r\n        \r\n        beforeUnmount() {\r\n            this.removeResizeListener();\r\n            this.inst.dispose();\r\n        },\r\n        \r\n    };\r\n}\r\n"],"names":["ResizeObserverSham","console","warn","noop","prototype","disconnect","observe","ResizeObserver","createComponent","echarts","h","name","isVue3","hooks","mounted","ctx","this","inst","init","$el","initTheme","initOpts","$data","_private","dynamic","loading","showLoading","loadingType","loadingOpts","events","forEach","args","on","apply","autoResize","addResizeListener","option","setTimeout","setOption","setOptionOpts","activated","deactivated","removeResizeListener","beforeUnmount","dispose","getHooks","beforeDestroy","render","getVue3Render","vue2Render","props","Object","String","type","Boolean","Array","data","freeze","observer","_this","resize","computed","watch","val","hideLoading","methods","opts","clientWidth","clientHeight","width","height","style","overflow","attrs","$attrs","app","options","definition","component"],"mappings":";;;;;;;46BACA,SAASA,IACLC,QAAQC,KAAK,iFAGjB,IAAMC,EAAO,aACbH,EAAmBI,UAAUC,WAAaF,EAC1CH,EAAmBI,UAAUE,QAAUH,QAGE,mBAAnBI,eAAgCA,eAAiBP,ECGhE,SAASQ,SACZC,IAAAA,QACAC,IAAAA,MACAH,eAAAA,aAAiBP,QACjBW,KAAAA,aAAO,YAEDC,EAAsB,mBAANF,EAChBG,ECnBH,SAAkBJ,SACd,CACHK,uBACUC,EAAMC,KACNC,EAAOR,EAAQS,KAAKH,EAAII,IAAKJ,EAAIK,UAAWL,EAAIM,UACtDN,EAAIO,MAAMC,SAASC,QAAQP,KAAOA,EAC9BF,EAAIU,SACJR,EAAKS,YAAYX,EAAIY,YAAaZ,EAAIa,aAEtCb,EAAIc,QACJd,EAAIc,OAAOC,SAAQ,SAAAC,UAAQd,EAAKe,GAAGC,MAAMhB,EAAMc,MAE/ChB,EAAImB,YACJnB,EAAIoB,oBAEJpB,EAAIqB,QAEJC,YAAW,WACPtB,EAAIuB,UAAUvB,EAAIqB,OAAQrB,EAAIwB,mBAK1CC,qBACQxB,KAAKkB,iBACAC,qBAIbM,uBACQzB,KAAKkB,iBACAQ,wBAIbC,8BACSD,4BACAzB,KAAK2B,YDlBJC,CAASpC,UAElBG,IACDC,EAAMiC,cAAgBjC,EAAM8B,qBACrB9B,EAAM8B,sBAIV9B,OAEHF,KAAAA,EACAoC,OAAQnC,EAASoC,EAActC,GAAKuC,EAEpCC,MAAO,CACH9B,UAAW,CAAC+B,OAAQC,QACpB/B,SAAU8B,OACV1B,QAAS,CACL4B,KAAMC,iBACG,GAEb3B,YAAa,CACT0B,KAAMD,eACG,WAEbxB,YAAcuB,OACdf,OAAQe,OACRZ,cAAeY,OACftB,OAAQ0B,MACRrB,WAAY,CACRmB,KAAMC,iBACG,IAIjBE,iCACW,CACHjC,SAAU4B,OAAOM,OAAO,CACpBC,SAAU,IAAInD,GAAe,kBAAMoD,EAAKC,YACxCpC,QAAS,OAKrBqC,SAAU,CACN5C,uBACWD,KAAKM,MAAMC,SAASC,QAAQP,OAI3C6C,MAAO,CACHrC,iBAAQsC,OACEhD,EAAMC,KACR+C,EACAhD,EAAIE,KAAKS,YAAYX,EAAIY,YAAaZ,EAAIa,aAE1Cb,EAAIE,KAAK+C,eAIjB5B,gBAAO2B,QACEzB,UAAUyB,EAAK/C,KAAKuB,gBAG7BL,oBAAW6B,GACHA,OACK5B,yBAEAO,yBAKjBuB,QAAS,CACL3B,mBAAUF,EAAQ8B,QACTjD,KAAKqB,UAAUF,SACbpB,KAAKuB,eACL2B,KAIXN,wBAC0C5C,KAAKG,IAAnCgD,IAAAA,YAAaC,IAAAA,kBAChBnD,KAAK2C,OAAO,CACbS,MAAOF,EACPG,OAAQF,KAIhBjC,kCACSb,MAAMC,SAASmC,SAASpD,QAAQU,KAAKG,MAG9CuB,qCACSpB,MAAMC,SAASmC,SAASrD,iBAS7C,IAAMkE,EAAQ,CACVD,OAAQ,OACRE,SAAU,UAId,SAASvB,EAAWvC,UACTA,EAAE,MAAO,CACZ+D,MAAOzD,KAAK0D,OACZH,MAAAA,IAKR,SAASvB,EAActC,UACZ,kBACIA,EAAE,aACFM,KAAK0D,YACRH,MAAAA,mCAWL,SAAgBI,EAAKC,OAClBC,EAAarE,EAAgBoE,GACnCD,EAAIG,UAAUD,EAAWlE,KAAMkE"}